%h1 Search#index

- if @shops.empty?
  There are no shops in that location
- else
  .row
    - @shops.each do |s|
      .col-md-5
        .card
          .col-md-5
            %img.card-img-top{:alt => "Card image cap", src: "http://placehold.it/318x180"}/
          .col-md-4
            .card-block
              %h4.card-title= s.name
              %p.card-text=s.description
              -# = link_to "Edit", edit_shop_path(s)
              -# = link_to "View", shop_path(s)
          .col-md-3
            .card-block
              .btn-group{:role => "group"}
                = link_to edit_shop_path(s), class: 'btn' do
                  Edit
                  -# %i.fa.fa-pencil-square-o.fa-lg
                = link_to shop_path(s), class: 'btn' do
                  View
                  -# %i.fa.fa-external-link-square.fa-lg


%h3 The shop locations #{@shop_locations[0]["longitude"]}

#searchMap{ style: "height: 400px; width: 500px;" }


:javascript
  var locations = #{@shop_locations}

  var map = new google.maps.Map(document.getElementById('searchMap'), {
    zoom: 13,
    center: new google.maps.LatLng(locations[0]["latitude"], locations[0]["longitude"]),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });

  var infowindow = new google.maps.InfoWindow();

  var marker, i;

  for (i = 0; i < locations.length; i++) {
    marker = new google.maps.Marker({
      position: new google.maps.LatLng(locations[i]["latitude"], locations[i]["longitude"]),
      map: map,
      maxWidth: 200
    });

    var infoWindowContent = '<a href="/shops/ ' + locations[i]["id"] +  '" > ' + locations[i]["name"] + ' </a>'
    google.maps.event.addListener(marker, 'click', (function(marker, i) {
      return function() {
        infowindow.setContent(infoWindowContent);
        infowindow.open(map, marker);
      }
    })(marker, i));
  }
