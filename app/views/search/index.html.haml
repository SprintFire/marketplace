

- if @shops.empty?
  There are no shops in that location
- else
  .row.search-page-container
    .col-md-4.product-container
      %h3 Products
      - @shops.each do |s|
        - s.products.each do |p|
          .product-card.col-md-12
            .col-md-9.m-b-1
              = link_to "#{p.name} at #{s.name}", shop_product_path(s, p), class: "p-b-1"
              %p= p.description
            .col-md-3.m-b-1
              %strong.pull-xs-right.m-b-1
                &euro;
                = number_with_precision(p.price, precision: 2)
              = link_to "View Details", shop_product_path(s, p), class: 'btn btn-success'

    .col-md-8.map-container
      #searchMap{ style: "height: 600px;" }

:javascript
  var locations = #{@shop_locations}

  var map = new google.maps.Map(document.getElementById('searchMap'), {
    zoom: 14,
    center: new google.maps.LatLng(locations[0]["latitude"], locations[0]["longitude"]),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });

  var infowindow = new google.maps.InfoWindow();

  var marker, i;

  for (i = 0; i < locations.length; i++) {
    var infoWindowContent = '<div class="row"> \
        <div class="col-md-8" > \
          <a href="/shops/ ' + locations[i]["id"] +  '" > ' + locations[i]["name"] + ' </a>  \
          <p> ' + locations[i]["address"]+ ' </p> \
        </div> \
        <div class="col-md-4" > \
          <img class="img-fluid" src="http://placehold.it/250x250" > \
        </div> \
      </div> ';

    marker = new google.maps.Marker({
      position: new google.maps.LatLng(locations[i]["latitude"], locations[i]["longitude"]),
      map: map,
      maxWidth: 200,
      icon: "http://findicons.com/files/icons/2222/gloss_basic/32/pin_red.png"
    });

    google.maps.event.addListener(marker, 'click', (function(marker, i, infoWindowContent) {
      return function() {
        infowindow.setContent(infoWindowContent);
        infowindow.open(map, marker);
      }
    })(marker, i, infoWindowContent));


  }
